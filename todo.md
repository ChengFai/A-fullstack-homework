# TODO 任务清单

基于 `goal.md` 和 `goal_zh.md` 中的任务要求，分析当前代码实现情况后，以下是需要完成的任务：

## 核心功能实现状态

### ✅ 已完成的功能
- **用户认证系统**: JWT token认证、密码哈希、登录/注册接口
- **角色管理**: 员工和雇主角色区分，权限控制
- **票据管理**: 创建、查看、更新、删除票据功能
- **票据审批**: 雇主可以批准/拒绝票据
- **员工管理**: 雇主可以停用/激活员工账户
- **软删除机制**: 被停用员工的票据会被隐藏但保留在数据库中
- **前端页面**: 登录页、注册页、票据列表页、员工列表页
- **路由保护**: 基于角色的路由访问控制
- **状态管理**: Redux状态管理实现
- **基础测试**: 单元测试和集成测试框架已搭建

### ❌ 需要修复的Bug
1. **后端auth.py注册函数bug**: `register`函数中缺少`existing`变量检查（第33行）
2. **storage.py方法缩进问题**: `set_user_suspended`方法缩进不正确（第144行）

### ⚠️ 需要完善的功能

#### 数据库集成
- **PostgreSQL数据库**: 当前使用文件存储，需要实现PostgreSQL集成
- **SQLAlchemy + asyncpg**: 按照要求使用SQLAlchemy和asyncpg

#### 测试完善
- **集成测试**: 需要实现链式集成测试（GET->POST->GET验证）
- **测试覆盖率**: 提高测试覆盖率，确保所有功能都有测试

#### 部署配置
- **Docker部署**: 需要实现Docker容器化部署配置

#### 文档完善
- **README.md更新**: 
  - 添加测试运行说明
  - 添加black使用教程
  - 添加Docker部署说明

## 奖励任务完成状态

### ✅ 部分完成
- **单元测试**: 已设置测试脚手架，有基础测试用例

### ❌ 未完成

- **完整集成测试**: 缺少链式集成测试
- **Docker部署**: 未实现Docker配置

## 优先级排序

### 高优先级（Bug修复）
1. 修复auth.py注册函数bug
2. 修复storage.py方法缩进问题

### 中优先级（核心功能）
3. 实现PostgreSQL数据库集成
4. 完善集成测试

### 低优先级（奖励任务）
5. 设置Black格式化器
6. 实现Docker部署
7. 更新README文档

## 技术债务
- 当前使用文件存储作为临时方案，需要迁移到PostgreSQL
- 缺少完整的错误处理和输入验证
- 缺少API文档的详细说明
- 缺少性能优化和缓存机制

## 下一步行动
1. 立即修复发现的bug
2. 实现PostgreSQL数据库集成
3. 完善测试覆盖
4. 添加代码格式化工具
5. 实现Docker部署配置
6. 更新项目文档
